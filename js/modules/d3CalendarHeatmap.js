const PreventDuplicateScript_83=0;"use strict";var calendarHeatmap={settings:{gutter:5,item_gutter:1,width:1e3,height:200,item_size:10,label_padding:40,max_block_height:20,transition_duration:500,tooltip_width:250,tooltip_padding:15},init:function(o,s,u,l,m){calendarHeatmap.data=o,calendarHeatmap.container=s,calendarHeatmap.color=u||"#ff4500",calendarHeatmap.overview=l||"global",calendarHeatmap.history=["global"],calendarHeatmap.selected={},calendarHeatmap.handler=m,calendarHeatmap.in_transition=!1,calendarHeatmap.createElements(),calendarHeatmap.parseData(),calendarHeatmap.drawChart()},createElements:function(){if(calendarHeatmap.container!=null){var o=document.getElementById(calendarHeatmap.container);if(!o||o.tagName!="DIV")throw"Element not found or not of type div";o.classList.contains("calendar-heatmap")||o.classList.add("calendar-heatmap")}else{var o=document.createElement("div");o.className="calendar-heatmap",document.body.appendChild(o)}var s=d3.select(o).append("svg").attr("class","svg");calendarHeatmap.items=s.append("g"),calendarHeatmap.labels=s.append("g"),calendarHeatmap.buttons=s.append("g"),calendarHeatmap.tooltip=d3.select(o).append("div").attr("class","heatmap-tooltip").style("opacity",0);var u=function(){var l=Math.round((moment()-moment().subtract(1,"year").startOf("week"))/864e5),m=Math.trunc(l/7),i=m+1;calendarHeatmap.settings.width=o.offsetWidth<1e3?1e3:o.offsetWidth,calendarHeatmap.settings.item_size=(calendarHeatmap.settings.width-calendarHeatmap.settings.label_padding)/i-calendarHeatmap.settings.gutter,calendarHeatmap.settings.height=calendarHeatmap.settings.label_padding+7*(calendarHeatmap.settings.item_size+calendarHeatmap.settings.gutter),s.attr("width",calendarHeatmap.settings.width).attr("height",calendarHeatmap.settings.height),calendarHeatmap.data&&calendarHeatmap.data[0].summary&&calendarHeatmap.drawChart()};u(),window.onresize=function(l){u()}},parseData:function(){calendarHeatmap.data&&(calendarHeatmap.data[0].summary||calendarHeatmap.data.map(function(o){var s=o.details.reduce(function(l,m){return l[m.name]?l[m.name].value+=m.value:l[m.name]={value:m.value},l},{}),u=Object.keys(s).map(function(l){return{name:l,value:s[l].value}});return o.summary=u.sort(function(l,m){return m.value-l.value}),o}))},drawChart:function(){calendarHeatmap.overview==="global"?calendarHeatmap.drawGlobalOverview():calendarHeatmap.overview==="year"?calendarHeatmap.drawYearOverview():calendarHeatmap.overview==="month"?calendarHeatmap.drawMonthOverview():calendarHeatmap.overview==="week"?calendarHeatmap.drawWeekOverview():calendarHeatmap.overview==="day"&&calendarHeatmap.drawDayOverview()},drawGlobalOverview:function(){calendarHeatmap.history[calendarHeatmap.history.length-1]!==calendarHeatmap.overview&&calendarHeatmap.history.push(calendarHeatmap.overview);var o=moment(calendarHeatmap.data[0].date).startOf("year"),s=moment(calendarHeatmap.data[calendarHeatmap.data.length-1].date).endOf("year"),u=d3.timeYears(o,s).map(function(n){var a=moment(n);return{date:a,total:calendarHeatmap.data.reduce(function(f,g){return moment(g.date).year()===a.year()&&(f+=g.total),f},0),summary:function(){var f=calendarHeatmap.data.reduce(function(d,e){if(moment(e.date).year()===a.year())for(var t=0;t<e.summary.length;t++)d[e.summary[t].name]?d[e.summary[t].name].value+=e.summary[t].value:d[e.summary[t].name]={value:e.summary[t].value};return d},{}),g=Object.keys(f).map(function(d){return{name:d,value:f[d].value}});return g.sort(function(d,e){return e.value-d.value})}()}}),l=d3.max(u,function(n){return n.total}),m=d3.timeYears(o,s).map(function(n){return moment(n)}),i=d3.scaleBand().rangeRound([0,calendarHeatmap.settings.width]).padding([.05]).domain(m.map(function(n){return n.year()}));calendarHeatmap.items.selectAll(".item-block-year").remove(),calendarHeatmap.items.selectAll(".item-block-year").data(u).enter().append("rect").attr("class","item item-block-year").attr("width",function(){return(calendarHeatmap.settings.width-calendarHeatmap.settings.label_padding)/m.length-5*calendarHeatmap.settings.gutter}).attr("height",function(){return calendarHeatmap.settings.height-calendarHeatmap.settings.label_padding}).attr("transform",function(n){return"translate("+i(n.date.year())+","+2*calendarHeatmap.settings.tooltip_padding+")"}).attr("fill",function(n){var a=d3.scaleLinear().range(["#ffffff",calendarHeatmap.color||"#ff4500"]).domain([-.15*l,l]);return a(n.total)||"#ff4500"}).on("click",function(n){calendarHeatmap.in_transition||(calendarHeatmap.in_transition=!0,calendarHeatmap.selected=n,calendarHeatmap.hideTooltip(),calendarHeatmap.removeGlobalOverview(),calendarHeatmap.overview="year",calendarHeatmap.drawChart())}).style("opacity",0).on("mouseover",function(n){if(!calendarHeatmap.in_transition){var a="";a+="<div><span><strong>Total time tracked:</strong></span>";var f=parseInt(n.total,10),g=Math.floor(f/86400);g>0&&(a+="<span>"+(g===1?"1 day":g+" days")+"</span></div>");var d=Math.floor((f-86400*g)/3600);d>0&&(a+=g>0?"<div><span></span><span>"+(d===1?"1 hour":d+" hours")+"</span></div>":"<span>"+(d===1?"1 hour":d+" hours")+"</span></div>");var e=Math.floor((f-86400*g-3600*d)/60);if(e>0&&(a+=g>0||d>0?"<div><span></span><span>"+(e===1?"1 minute":e+" minutes")+"</span></div>":"<span>"+(e===1?"1 minute":e+" minutes")+"</span></div>"),a+="<br />",n.summary.length<=5)for(var t=0;t<n.summary.length;t++)a+="<div><span><strong>"+n.summary[t].name+"</strong></span>",a+="<span>"+calendarHeatmap.formatTime(n.summary[t].value)+"</span></div>";else{for(var t=0;t<5;t++)a+="<div><span><strong>"+n.summary[t].name+"</strong></span>",a+="<span>"+calendarHeatmap.formatTime(n.summary[t].value)+"</span></div>";a+="<br />";for(var r=0,t=5;t<n.summary.length;t++)r=+n.summary[t].value;a+="<div><span><strong>Other:</strong></span>",a+="<span>"+calendarHeatmap.formatTime(r)+"</span></div>"}for(var c=i(n.date.year())+2*calendarHeatmap.settings.tooltip_padding;calendarHeatmap.settings.width-c<calendarHeatmap.settings.tooltip_width+5*calendarHeatmap.settings.tooltip_padding;)c-=10;var p=this.getBoundingClientRect().top+calendarHeatmap.settings.tooltip_padding;calendarHeatmap.tooltip.html(a).style("left",c+"px").style("top",p+"px").transition().duration(calendarHeatmap.settings.transition_duration/2).ease(d3.easeLinear).style("opacity",1)}}).on("mouseout",function(){calendarHeatmap.in_transition||calendarHeatmap.hideTooltip()}).transition().delay(function(n,a){return calendarHeatmap.settings.transition_duration*(a+1)/10}).duration(function(){return calendarHeatmap.settings.transition_duration}).ease(d3.easeLinear).style("opacity",1).call(function(n,a){n.empty()&&a();var f=0;n.each(function(){++f}).on("end",function(){--f||a.apply(this,arguments)})},function(){calendarHeatmap.in_transition=!1}),calendarHeatmap.labels.selectAll(".label-year").remove(),calendarHeatmap.labels.selectAll(".label-year").data(m).enter().append("text").attr("class","label label-year").attr("font-size",function(){return Math.floor(calendarHeatmap.settings.label_padding/3)+"px"}).text(function(n){return n.year()}).attr("x",function(n){return i(n.year())}).attr("y",calendarHeatmap.settings.label_padding/2).on("mouseenter",function(n){calendarHeatmap.in_transition||calendarHeatmap.items.selectAll(".item-block-year").transition().duration(calendarHeatmap.settings.transition_duration).ease(d3.easeLinear).style("opacity",function(a){return moment(a.date).year()===n.year()?1:.1})}).on("mouseout",function(){calendarHeatmap.in_transition||calendarHeatmap.items.selectAll(".item-block-year").transition().duration(calendarHeatmap.settings.transition_duration).ease(d3.easeLinear).style("opacity",1)}).on("click",function(n){calendarHeatmap.in_transition||(calendarHeatmap.in_transition=!0,calendarHeatmap.selected={date:n},calendarHeatmap.hideTooltip(),calendarHeatmap.removeGlobalOverview(),calendarHeatmap.overview="year",calendarHeatmap.drawChart())})},drawYearOverview:function(){calendarHeatmap.history[calendarHeatmap.history.length-1]!==calendarHeatmap.overview&&calendarHeatmap.history.push(calendarHeatmap.overview);var o=moment(calendarHeatmap.selected.date).startOf("year"),s=moment(calendarHeatmap.selected.date).endOf("year"),u=calendarHeatmap.data.filter(function(t){return o<=moment(t.date)&&moment(t.date)<s}),l=d3.max(u,function(t){return t.total}),m=d3.scaleLinear().range(["#ffffff",calendarHeatmap.color||"#ff4500"]).domain([-.15*l,l]),i=function(t){var r=moment(t.date),c=Math.round((r-moment(o).startOf("week"))/864e5),p=Math.trunc(c/7);return p*(calendarHeatmap.settings.item_size+calendarHeatmap.settings.gutter)+calendarHeatmap.settings.label_padding},n=function(t){return calendarHeatmap.settings.label_padding+moment(t.date).weekday()*(calendarHeatmap.settings.item_size+calendarHeatmap.settings.gutter)},a=function(t){return l<=0?calendarHeatmap.settings.item_size:.75*calendarHeatmap.settings.item_size+calendarHeatmap.settings.item_size*t.total/l*.25};calendarHeatmap.items.selectAll(".item-circle").remove(),calendarHeatmap.items.selectAll(".item-circle").data(u).enter().append("rect").attr("class","item item-circle").style("opacity",0).attr("x",function(t){return i(t)+(calendarHeatmap.settings.item_size-a(t))/2}).attr("y",function(t){return n(t)+(calendarHeatmap.settings.item_size-a(t))/2}).attr("rx",function(t){return a(t)}).attr("ry",function(t){return a(t)}).attr("width",function(t){return a(t)}).attr("height",function(t){return a(t)}).attr("fill",function(t){return t.total>0?m(t.total):"transparent"}).on("click",function(t){calendarHeatmap.in_transition||t.total!==0&&(calendarHeatmap.in_transition=!0,calendarHeatmap.selected=t,calendarHeatmap.hideTooltip(),calendarHeatmap.removeYearOverview(),calendarHeatmap.overview="day",calendarHeatmap.drawChart())}).on("mouseover",function(t){if(!calendarHeatmap.in_transition){var r=d3.select(this);(function b(){r=r.transition().duration(calendarHeatmap.settings.transition_duration).ease(d3.easeLinear).attr("x",function(h){return i(h)-(1.1*calendarHeatmap.settings.item_size-calendarHeatmap.settings.item_size)/2}).attr("y",function(h){return n(h)-(1.1*calendarHeatmap.settings.item_size-calendarHeatmap.settings.item_size)/2}).attr("width",1.1*calendarHeatmap.settings.item_size).attr("height",1.1*calendarHeatmap.settings.item_size).transition().duration(calendarHeatmap.settings.transition_duration).ease(d3.easeLinear).attr("x",function(h){return i(h)+(calendarHeatmap.settings.item_size-a(h))/2}).attr("y",function(h){return n(h)+(calendarHeatmap.settings.item_size-a(h))/2}).attr("width",function(h){return a(h)}).attr("height",function(h){return a(h)}).on("end",b)})();var c="";c+='<div class="header"><strong>'+(t.total?calendarHeatmap.formatTime(t.total):"No time")+" tracked</strong></div>",c+="<div>on "+moment(t.date).format("dddd, MMM Do YYYY")+"</div><br>";for(var p=0;p<t.summary.length;p++)c+="<div><span><strong>"+t.summary[p].name+"</strong></span>",c+="<span>"+calendarHeatmap.formatTime(t.summary[p].value)+"</span></div>";var v=i(t)+calendarHeatmap.settings.item_size;calendarHeatmap.settings.width-v<calendarHeatmap.settings.tooltip_width+3*calendarHeatmap.settings.tooltip_padding&&(v-=calendarHeatmap.settings.tooltip_width+2*calendarHeatmap.settings.tooltip_padding);var y=this.getBoundingClientRect().top+calendarHeatmap.settings.item_size;calendarHeatmap.tooltip.html(c).style("left",v+"px").style("top",y+"px").transition().duration(calendarHeatmap.settings.transition_duration/2).ease(d3.easeLinear).style("opacity",1)}}).on("mouseout",function(){calendarHeatmap.in_transition||(d3.select(this).transition().duration(calendarHeatmap.settings.transition_duration/2).ease(d3.easeLinear).attr("x",function(t){return i(t)+(calendarHeatmap.settings.item_size-a(t))/2}).attr("y",function(t){return n(t)+(calendarHeatmap.settings.item_size-a(t))/2}).attr("width",function(t){return a(t)}).attr("height",function(t){return a(t)}),calendarHeatmap.hideTooltip())}).transition().delay(function(){return(Math.cos(Math.PI*Math.random())+1)*calendarHeatmap.settings.transition_duration}).duration(function(){return calendarHeatmap.settings.transition_duration}).ease(d3.easeLinear).style("opacity",1).call(function(t,r){t.empty()&&r();var c=0;t.each(function(){++c}).on("end",function(){--c||r.apply(this,arguments)})},function(){calendarHeatmap.in_transition=!1});var f=d3.timeMonths(o,s),g=d3.scaleLinear().range([0,calendarHeatmap.settings.width]).domain([0,f.length]);calendarHeatmap.labels.selectAll(".label-month").remove(),calendarHeatmap.labels.selectAll(".label-month").data(f).enter().append("text").attr("class","label label-month").attr("font-size",function(){return Math.floor(calendarHeatmap.settings.label_padding/3)+"px"}).text(function(t){return t.toLocaleDateString("en-us",{month:"short"})}).attr("x",function(t,r){return g(r)+(g(r)-g(r-1))/2}).attr("y",calendarHeatmap.settings.label_padding/2).on("mouseenter",function(t){if(!calendarHeatmap.in_transition){var r=moment(t);calendarHeatmap.items.selectAll(".item-circle").transition().duration(calendarHeatmap.settings.transition_duration).ease(d3.easeLinear).style("opacity",function(c){return moment(c.date).isSame(r,"month")?1:.1})}}).on("mouseout",function(){calendarHeatmap.in_transition||calendarHeatmap.items.selectAll(".item-circle").transition().duration(calendarHeatmap.settings.transition_duration).ease(d3.easeLinear).style("opacity",1)}).on("click",function(t){if(!calendarHeatmap.in_transition){var r=calendarHeatmap.data.filter(function(c){return moment(t).startOf("month")<=moment(c.date)&&moment(c.date)<moment(t).endOf("month")});r.length&&(calendarHeatmap.selected={date:t},calendarHeatmap.in_transition=!0,calendarHeatmap.hideTooltip(),calendarHeatmap.removeYearOverview(),calendarHeatmap.overview="month",calendarHeatmap.drawChart())}});var d=d3.timeDays(moment().startOf("week"),moment().endOf("week")),e=d3.scaleBand().rangeRound([calendarHeatmap.settings.label_padding,calendarHeatmap.settings.height]).domain(d.map(function(t){return moment(t).weekday()}));calendarHeatmap.labels.selectAll(".label-day").remove(),calendarHeatmap.labels.selectAll(".label-day").data(d).enter().append("text").attr("class","label label-day").attr("x",calendarHeatmap.settings.label_padding/3).attr("y",function(t,r){return e(r)+e.bandwidth()/1.75}).style("text-anchor","left").attr("font-size",function(){return Math.floor(calendarHeatmap.settings.label_padding/3)+"px"}).text(function(t){return moment(t).format("dddd")[0]}).on("mouseenter",function(t){if(!calendarHeatmap.in_transition){var r=moment(t);calendarHeatmap.items.selectAll(".item-circle").transition().duration(calendarHeatmap.settings.transition_duration).ease(d3.easeLinear).style("opacity",function(c){return moment(c.date).day()===r.day()?1:.1})}}).on("mouseout",function(){calendarHeatmap.in_transition||calendarHeatmap.items.selectAll(".item-circle").transition().duration(calendarHeatmap.settings.transition_duration).ease(d3.easeLinear).style("opacity",1)}),calendarHeatmap.drawButton()},drawMonthOverview:function(){calendarHeatmap.history[calendarHeatmap.history.length-1]!==calendarHeatmap.overview&&calendarHeatmap.history.push(calendarHeatmap.overview);for(var o=moment(calendarHeatmap.selected.date).startOf("month"),s=moment(calendarHeatmap.selected.date).endOf("month"),u=calendarHeatmap.data.filter(function(e){return o<=moment(e.date)&&moment(e.date)<s}),l=d3.max(u,function(e){return d3.max(e.summary,function(t){return t.value})}),m=d3.timeDays(moment().startOf("week"),moment().endOf("week")),i=d3.scaleBand().rangeRound([calendarHeatmap.settings.label_padding,calendarHeatmap.settings.height]).domain(m.map(function(e){return moment(e).weekday()})),n=[o.clone()];o.week()!==s.week();)n.push(o.add(1,"week").clone());var a=d3.scaleBand().rangeRound([calendarHeatmap.settings.label_padding,calendarHeatmap.settings.width]).padding([.05]).domain(n.map(function(e){return e.week()}));calendarHeatmap.items.selectAll(".item-block-month").remove();var f=calendarHeatmap.items.selectAll(".item-block-month").data(u).enter().append("g").attr("class","item item-block-month").attr("width",function(){return(calendarHeatmap.settings.width-calendarHeatmap.settings.label_padding)/n.length-5*calendarHeatmap.settings.gutter}).attr("height",function(){return Math.min(i.bandwidth(),calendarHeatmap.settings.max_block_height)}).attr("transform",function(e){return"translate("+a(moment(e.date).week())+","+(i(moment(e.date).weekday())+i.bandwidth()/1.75-15)+")"}).attr("total",function(e){return e.total}).attr("date",function(e){return e.date}).attr("offset",0).on("click",function(e){calendarHeatmap.in_transition||e.total!==0&&(calendarHeatmap.in_transition=!0,calendarHeatmap.selected=e,calendarHeatmap.hideTooltip(),calendarHeatmap.removeMonthOverview(),calendarHeatmap.overview="day",calendarHeatmap.drawChart())}),g=(calendarHeatmap.settings.width-calendarHeatmap.settings.label_padding)/n.length-5*calendarHeatmap.settings.gutter,d=d3.scaleLinear().rangeRound([0,g]);f.selectAll(".item-block-rect").data(function(e){return e.summary}).enter().append("rect").attr("class","item item-block-rect").attr("x",function(e){var t=parseInt(d3.select(this.parentNode).attr("total")),r=parseInt(d3.select(this.parentNode).attr("offset"));return d.domain([0,t]),d3.select(this.parentNode).attr("offset",r+d(e.value)),r}).attr("width",function(e){var t=parseInt(d3.select(this.parentNode).attr("total"));return d.domain([0,t]),Math.max(d(e.value)-calendarHeatmap.settings.item_gutter,1)}).attr("height",function(){return Math.min(i.bandwidth(),calendarHeatmap.settings.max_block_height)}).attr("fill",function(e){var t=d3.scaleLinear().range(["#ffffff",calendarHeatmap.color||"#ff4500"]).domain([-.15*l,l]);return t(e.value)||"#ff4500"}).style("opacity",0).on("mouseover",function(e){if(!calendarHeatmap.in_transition){var t=new Date(d3.select(this.parentNode).attr("date")),r="";r+='<div class="header"><strong>'+e.name+"</strong></div><br>",r+="<div><strong>"+(e.value?calendarHeatmap.formatTime(e.value):"No time")+" tracked</strong></div>",r+="<div>on "+moment(t).format("dddd, MMM Do YYYY")+"</div>";for(var c=a(moment(t).week())+calendarHeatmap.settings.tooltip_padding;calendarHeatmap.settings.width-c<calendarHeatmap.settings.tooltip_width+3*calendarHeatmap.settings.tooltip_padding;)c-=10;var p=this.getBoundingClientRect().top+calendarHeatmap.settings.tooltip_padding;calendarHeatmap.tooltip.html(r).style("left",c+"px").style("top",p+"px").transition().duration(calendarHeatmap.settings.transition_duration/2).ease(d3.easeLinear).style("opacity",1)}}).on("mouseout",function(){calendarHeatmap.in_transition||calendarHeatmap.hideTooltip()}).transition().delay(function(){return(Math.cos(Math.PI*Math.random())+1)*calendarHeatmap.settings.transition_duration}).duration(function(){return calendarHeatmap.settings.transition_duration}).ease(d3.easeLinear).style("opacity",1).call(function(e,t){e.empty()&&t();var r=0;e.each(function(){++r}).on("end",function(){--r||t.apply(this,arguments)})},function(){calendarHeatmap.in_transition=!1}),calendarHeatmap.labels.selectAll(".label-week").remove(),calendarHeatmap.labels.selectAll(".label-week").data(n).enter().append("text").attr("class","label label-week").attr("font-size",function(){return Math.floor(calendarHeatmap.settings.label_padding/3)+"px"}).text(function(e){return"Week "+e.week()}).attr("x",function(e){return a(e.week())}).attr("y",calendarHeatmap.settings.label_padding/2).on("mouseenter",function(e){calendarHeatmap.in_transition||calendarHeatmap.items.selectAll(".item-block-month").transition().duration(calendarHeatmap.settings.transition_duration).ease(d3.easeLinear).style("opacity",function(t){return moment(t.date).week()===e.week()?1:.1})}).on("mouseout",function(){calendarHeatmap.in_transition||calendarHeatmap.items.selectAll(".item-block-month").transition().duration(calendarHeatmap.settings.transition_duration).ease(d3.easeLinear).style("opacity",1)}).on("click",function(e){if(!calendarHeatmap.in_transition){var t=calendarHeatmap.data.filter(function(r){return e.startOf("week")<=moment(r.date)&&moment(r.date)<e.endOf("week")});t.length&&(calendarHeatmap.in_transition=!0,calendarHeatmap.selected={date:e},calendarHeatmap.hideTooltip(),calendarHeatmap.removeMonthOverview(),calendarHeatmap.overview="week",calendarHeatmap.drawChart())}}),calendarHeatmap.labels.selectAll(".label-day").remove(),calendarHeatmap.labels.selectAll(".label-day").data(m).enter().append("text").attr("class","label label-day").attr("x",calendarHeatmap.settings.label_padding/3).attr("y",function(e,t){return i(t)+i.bandwidth()/1.75}).style("text-anchor","left").attr("font-size",function(){return Math.floor(calendarHeatmap.settings.label_padding/3)+"px"}).text(function(e){return moment(e).format("dddd")[0]}).on("mouseenter",function(e){if(!calendarHeatmap.in_transition){var t=moment(e);calendarHeatmap.items.selectAll(".item-block-month").transition().duration(calendarHeatmap.settings.transition_duration).ease(d3.easeLinear).style("opacity",function(r){return moment(r.date).day()===t.day()?1:.1})}}).on("mouseout",function(){calendarHeatmap.in_transition||calendarHeatmap.items.selectAll(".item-block-month").transition().duration(calendarHeatmap.settings.transition_duration).ease(d3.easeLinear).style("opacity",1)}),calendarHeatmap.drawButton()},drawWeekOverview:function(){calendarHeatmap.history[calendarHeatmap.history.length-1]!==calendarHeatmap.overview&&calendarHeatmap.history.push(calendarHeatmap.overview);var o=moment(calendarHeatmap.selected.date).startOf("week"),s=moment(calendarHeatmap.selected.date).endOf("week"),u=calendarHeatmap.data.filter(function(e){return o<=moment(e.date)&&moment(e.date)<s}),l=d3.max(u,function(e){return d3.max(e.summary,function(t){return t.value})}),m=d3.timeDays(moment().startOf("week"),moment().endOf("week")),i=d3.scaleBand().rangeRound([calendarHeatmap.settings.label_padding,calendarHeatmap.settings.height]).domain(m.map(function(e){return moment(e).weekday()})),n=[o],a=d3.scaleBand().rangeRound([calendarHeatmap.settings.label_padding,calendarHeatmap.settings.width]).padding([.01]).domain(n.map(function(e){return e.week()}));calendarHeatmap.items.selectAll(".item-block-week").remove();var f=calendarHeatmap.items.selectAll(".item-block-week").data(u).enter().append("g").attr("class","item item-block-week").attr("width",function(){return(calendarHeatmap.settings.width-calendarHeatmap.settings.label_padding)/n.length-5*calendarHeatmap.settings.gutter}).attr("height",function(){return Math.min(i.bandwidth(),calendarHeatmap.settings.max_block_height)}).attr("transform",function(e){return"translate("+a(moment(e.date).week())+","+(i(moment(e.date).weekday())+i.bandwidth()/1.75-15)+")"}).attr("total",function(e){return e.total}).attr("date",function(e){return e.date}).attr("offset",0).on("click",function(e){calendarHeatmap.in_transition||e.total!==0&&(calendarHeatmap.in_transition=!0,calendarHeatmap.selected=e,calendarHeatmap.hideTooltip(),calendarHeatmap.removeWeekOverview(),calendarHeatmap.overview="day",calendarHeatmap.drawChart())}),g=(calendarHeatmap.settings.width-calendarHeatmap.settings.label_padding)/n.length-5*calendarHeatmap.settings.gutter,d=d3.scaleLinear().rangeRound([0,g]);f.selectAll(".item-block-rect").data(function(e){return e.summary}).enter().append("rect").attr("class","item item-block-rect").attr("x",function(e){var t=parseInt(d3.select(this.parentNode).attr("total")),r=parseInt(d3.select(this.parentNode).attr("offset"));return d.domain([0,t]),d3.select(this.parentNode).attr("offset",r+d(e.value)),r}).attr("width",function(e){var t=parseInt(d3.select(this.parentNode).attr("total"));return d.domain([0,t]),Math.max(d(e.value)-calendarHeatmap.settings.item_gutter,1)}).attr("height",function(){return Math.min(i.bandwidth(),calendarHeatmap.settings.max_block_height)}).attr("fill",function(e){var t=d3.scaleLinear().range(["#ffffff",calendarHeatmap.color||"#ff4500"]).domain([-.15*l,l]);return t(e.value)||"#ff4500"}).style("opacity",0).on("mouseover",function(e){if(!calendarHeatmap.in_transition){var t=new Date(d3.select(this.parentNode).attr("date")),r="";r+='<div class="header"><strong>'+e.name+"</strong></div><br>",r+="<div><strong>"+(e.value?calendarHeatmap.formatTime(e.value):"No time")+" tracked</strong></div>",r+="<div>on "+moment(t).format("dddd, MMM Do YYYY")+"</div>";var c=parseInt(d3.select(this.parentNode).attr("total"));d.domain([0,c]);for(var p=parseInt(d3.select(this).attr("x"))+d(e.value)/4+calendarHeatmap.settings.tooltip_width/4;calendarHeatmap.settings.width-p<calendarHeatmap.settings.tooltip_width+3*calendarHeatmap.settings.tooltip_padding;)p-=10;var v=this.getBoundingClientRect().top+calendarHeatmap.settings.tooltip_padding;calendarHeatmap.tooltip.html(r).style("left",p+"px").style("top",v+"px").transition().duration(calendarHeatmap.settings.transition_duration/2).ease(d3.easeLinear).style("opacity",1)}}).on("mouseout",function(){calendarHeatmap.in_transition||calendarHeatmap.hideTooltip()}).transition().delay(function(){return(Math.cos(Math.PI*Math.random())+1)*calendarHeatmap.settings.transition_duration}).duration(function(){return calendarHeatmap.settings.transition_duration}).ease(d3.easeLinear).style("opacity",1).call(function(e,t){e.empty()&&t();var r=0;e.each(function(){++r}).on("end",function(){--r||t.apply(this,arguments)})},function(){calendarHeatmap.in_transition=!1}),calendarHeatmap.labels.selectAll(".label-week").remove(),calendarHeatmap.labels.selectAll(".label-week").data(n).enter().append("text").attr("class","label label-week").attr("font-size",function(){return Math.floor(calendarHeatmap.settings.label_padding/3)+"px"}).text(function(e){return"Week "+e.week()}).attr("x",function(e){return a(e.week())}).attr("y",calendarHeatmap.settings.label_padding/2).on("mouseenter",function(e){calendarHeatmap.in_transition||calendarHeatmap.items.selectAll(".item-block-week").transition().duration(calendarHeatmap.settings.transition_duration).ease(d3.easeLinear).style("opacity",function(t){return moment(t.date).week()===e.week()?1:.1})}).on("mouseout",function(){calendarHeatmap.in_transition||calendarHeatmap.items.selectAll(".item-block-week").transition().duration(calendarHeatmap.settings.transition_duration).ease(d3.easeLinear).style("opacity",1)}),calendarHeatmap.labels.selectAll(".label-day").remove(),calendarHeatmap.labels.selectAll(".label-day").data(m).enter().append("text").attr("class","label label-day").attr("x",calendarHeatmap.settings.label_padding/3).attr("y",function(e,t){return i(t)+i.bandwidth()/1.75}).style("text-anchor","left").attr("font-size",function(){return Math.floor(calendarHeatmap.settings.label_padding/3)+"px"}).text(function(e){return moment(e).format("dddd")[0]}).on("mouseenter",function(e){if(!calendarHeatmap.in_transition){var t=moment(e);calendarHeatmap.items.selectAll(".item-block-week").transition().duration(calendarHeatmap.settings.transition_duration).ease(d3.easeLinear).style("opacity",function(r){return moment(r.date).day()===t.day()?1:.1})}}).on("mouseout",function(){calendarHeatmap.in_transition||calendarHeatmap.items.selectAll(".item-block-week").transition().duration(calendarHeatmap.settings.transition_duration).ease(d3.easeLinear).style("opacity",1)}),calendarHeatmap.drawButton()},drawDayOverview:function(){calendarHeatmap.history[calendarHeatmap.history.length-1]!==calendarHeatmap.overview&&calendarHeatmap.history.push(calendarHeatmap.overview),Object.keys(calendarHeatmap.selected).length||(calendarHeatmap.selected=calendarHeatmap.data[calendarHeatmap.data.length-1]);var o=calendarHeatmap.selected.summary.map(function(i){return i.name}),s=d3.scaleBand().rangeRound([calendarHeatmap.settings.label_padding,calendarHeatmap.settings.height]).domain(o),u=d3.scaleTime().range([2*calendarHeatmap.settings.label_padding,calendarHeatmap.settings.width]).domain([moment(calendarHeatmap.selected.date).startOf("day"),moment(calendarHeatmap.selected.date).endOf("day")]);calendarHeatmap.items.selectAll(".item-block").remove(),calendarHeatmap.items.selectAll(".item-block").data(calendarHeatmap.selected.details).enter().append("rect").attr("class","item item-block").attr("x",function(i){return u(moment(i.date))}).attr("y",function(i){return s(i.name)+s.bandwidth()/2-15}).attr("width",function(i){var n=u(d3.timeSecond.offset(moment(i.date),i.value));return Math.max(n-u(moment(i.date)),1)}).attr("height",function(){return Math.min(s.bandwidth(),calendarHeatmap.settings.max_block_height)}).attr("fill",function(i){return i.color||calendarHeatmap.color||"#ff4500"}).style("opacity",0).on("mouseover",function(i){if(!calendarHeatmap.in_transition){var n="";n+='<div class="header"><strong>'+i.name+"</strong><div><br>",n+="<div><strong>"+(i.value?calendarHeatmap.formatTime(i.value):"No time")+" tracked</strong></div>",n+="<div>on "+moment(i.date).format("dddd, MMM Do YYYY HH:mm")+"</div>";for(var a=100*i.value/86400+u(moment(i.date));calendarHeatmap.settings.width-a<calendarHeatmap.settings.tooltip_width+3*calendarHeatmap.settings.tooltip_padding;)a-=10;var f=this.getBoundingClientRect().top+calendarHeatmap.settings.tooltip_padding;calendarHeatmap.tooltip.html(n).style("left",a+"px").style("top",f+"px").transition().duration(calendarHeatmap.settings.transition_duration/2).ease(d3.easeLinear).style("opacity",1)}}).on("mouseout",function(){calendarHeatmap.in_transition||calendarHeatmap.hideTooltip()}).on("click",function(i){calendarHeatmap.handler&&typeof calendarHeatmap.handler=="function"&&calendarHeatmap.handler(i)}).transition().delay(function(){return(Math.cos(Math.PI*Math.random())+1)*calendarHeatmap.settings.transition_duration}).duration(function(){return calendarHeatmap.settings.transition_duration}).ease(d3.easeLinear).style("opacity",.5).call(function(i,n){i.empty()&&n();var a=0;i.each(function(){++a}).on("end",function(){--a||n.apply(this,arguments)})},function(){calendarHeatmap.in_transition=!1});var l=d3.timeHours(moment(calendarHeatmap.selected.date).startOf("day"),moment(calendarHeatmap.selected.date).endOf("day")),m=d3.scaleTime().range([2*calendarHeatmap.settings.label_padding,calendarHeatmap.settings.width]).domain([0,l.length]);calendarHeatmap.labels.selectAll(".label-time").remove(),calendarHeatmap.labels.selectAll(".label-time").data(l).enter().append("text").attr("class","label label-time").attr("font-size",function(){return Math.floor(calendarHeatmap.settings.label_padding/3)+"px"}).text(function(i){return moment(i).format("HH:mm")}).attr("x",function(i,n){return m(n)}).attr("y",calendarHeatmap.settings.label_padding/2).on("mouseenter",function(i){if(!calendarHeatmap.in_transition){var n=u(moment(i));calendarHeatmap.items.selectAll(".item-block").transition().duration(calendarHeatmap.settings.transition_duration).ease(d3.easeLinear).style("opacity",function(a){var f=u(moment(a.date)),g=u(moment(a.date).add(a.value,"seconds"));return n>=f&&n<=g?1:.1})}}).on("mouseout",function(){calendarHeatmap.in_transition||calendarHeatmap.items.selectAll(".item-block").transition().duration(calendarHeatmap.settings.transition_duration).ease(d3.easeLinear).style("opacity",.5)}),calendarHeatmap.labels.selectAll(".label-project").remove(),calendarHeatmap.labels.selectAll(".label-project").data(o).enter().append("text").attr("class","label label-project").attr("x",calendarHeatmap.settings.gutter).attr("y",function(i){return s(i)+s.bandwidth()/2}).attr("min-height",function(){return s.bandwidth()}).style("text-anchor","left").attr("font-size",function(){return Math.floor(calendarHeatmap.settings.label_padding/3)+"px"}).text(function(i){return i}).each(function(){for(var i=d3.select(this),n=i.node().getComputedTextLength(),a=i.text();n>1.5*calendarHeatmap.settings.label_padding&&a.length>0;)a=a.slice(0,-1),i.text(a+"..."),n=i.node().getComputedTextLength()}).on("mouseenter",function(i){calendarHeatmap.in_transition||calendarHeatmap.items.selectAll(".item-block").transition().duration(calendarHeatmap.settings.transition_duration).ease(d3.easeLinear).style("opacity",function(n){return n.name===i?1:.1})}).on("mouseout",function(){calendarHeatmap.in_transition||calendarHeatmap.items.selectAll(".item-block").transition().duration(calendarHeatmap.settings.transition_duration).ease(d3.easeLinear).style("opacity",.5)}),calendarHeatmap.drawButton()},drawButton:function(){calendarHeatmap.buttons.selectAll(".button").remove();var o=calendarHeatmap.buttons.append("g").attr("class","button button-back").style("opacity",0).on("click",function(){calendarHeatmap.in_transition||(calendarHeatmap.in_transition=!0,calendarHeatmap.overview==="year"?calendarHeatmap.removeYearOverview():calendarHeatmap.overview==="month"?calendarHeatmap.removeMonthOverview():calendarHeatmap.overview==="week"?calendarHeatmap.removeWeekOverview():calendarHeatmap.overview==="day"&&calendarHeatmap.removeDayOverview(),calendarHeatmap.history.pop(),calendarHeatmap.overview=calendarHeatmap.history.pop(),calendarHeatmap.drawChart())});o.append("circle").attr("cx",calendarHeatmap.settings.label_padding/2.25).attr("cy",calendarHeatmap.settings.label_padding/2.5).attr("r",calendarHeatmap.settings.item_size/2),o.append("text").attr("x",calendarHeatmap.settings.label_padding/2.25).attr("y",calendarHeatmap.settings.label_padding/2.5).attr("dy",function(){return Math.floor(calendarHeatmap.settings.width/100)/3}).attr("font-size",function(){return Math.floor(calendarHeatmap.settings.label_padding/3)+"px"}).html("&#x2190;"),o.transition().duration(calendarHeatmap.settings.transition_duration).ease(d3.easeLinear).style("opacity",1)},removeGlobalOverview:function(){calendarHeatmap.items.selectAll(".item-block-year").transition().duration(calendarHeatmap.settings.transition_duration).ease(d3.easeLinear).style("opacity",0).remove(),calendarHeatmap.labels.selectAll(".label-year").remove()},removeYearOverview:function(){calendarHeatmap.items.selectAll(".item-circle").transition().duration(calendarHeatmap.settings.transition_duration).ease(d3.easeLinear).style("opacity",0).remove(),calendarHeatmap.labels.selectAll(".label-day").remove(),calendarHeatmap.labels.selectAll(".label-month").remove(),calendarHeatmap.hideBackButton()},removeMonthOverview:function(){calendarHeatmap.items.selectAll(".item-block-month").selectAll(".item-block-rect").transition().duration(calendarHeatmap.settings.transition_duration).ease(d3.easeLinear).style("opacity",0).attr("x",function(o,s){return s%2===0?-calendarHeatmap.settings.width/3:calendarHeatmap.settings.width/3}).remove(),calendarHeatmap.labels.selectAll(".label-day").remove(),calendarHeatmap.labels.selectAll(".label-week").remove(),calendarHeatmap.hideBackButton()},removeWeekOverview:function(){calendarHeatmap.items.selectAll(".item-block-week").selectAll(".item-block-rect").transition().duration(calendarHeatmap.settings.transition_duration).ease(d3.easeLinear).style("opacity",0).attr("x",function(o,s){return s%2===0?-calendarHeatmap.settings.width/3:calendarHeatmap.settings.width/3}).remove(),calendarHeatmap.labels.selectAll(".label-day").remove(),calendarHeatmap.labels.selectAll(".label-week").remove(),calendarHeatmap.hideBackButton()},removeDayOverview:function(){calendarHeatmap.items.selectAll(".item-block").transition().duration(calendarHeatmap.settings.transition_duration).ease(d3.easeLinear).style("opacity",0).attr("x",function(o,s){return s%2===0?-calendarHeatmap.settings.width/3:calendarHeatmap.settings.width/3}).remove(),calendarHeatmap.labels.selectAll(".label-time").remove(),calendarHeatmap.labels.selectAll(".label-project").remove(),calendarHeatmap.hideBackButton()},hideTooltip:function(){calendarHeatmap.tooltip.transition().duration(calendarHeatmap.settings.transition_duration/2).ease(d3.easeLinear).style("opacity",0)},hideBackButton:function(){calendarHeatmap.buttons.selectAll(".button").transition().duration(calendarHeatmap.settings.transition_duration).ease(d3.easeLinear).style("opacity",0).remove()},formatTime:function(o){var s=Math.floor(o/3600),u=Math.floor((o-3600*s)/60),l="";return s>0&&(l+=s===1?"1 hour ":s+" hours "),u>0&&(l+=u===1?"1 minute":u+" minutes"),s===0&&u===0&&(l=Math.round(o)+" seconds"),l}};

//# sourceMappingURL=https://roqol.io/assets/sourcemap/chrome/2.33.1/js/modules/d3CalendarHeatmap.js