const PreventDuplicateScript_114=0;IsFeatureEnabled("BestFriends").then(async function(q){if(!q)return;const[O,T]=await RequestFunc(WebServerEndpoints.BestFriendsV2+"all","GET"),r=T?.Friends,z=T?.Max;if(!O||r.length===0)return;const o=document.createElement("div");o.id="best-friend-list-container",o.setAttribute("people-list-container",""),o.innerHTML=`<div class="col-xs-12 people-list-container" ng-show="layout.isAllFriendsDataLoaded &amp;&amp; library.numOfFriends > 0 || layout.friendsError"> <div class="section home-friends"> <div class="container-header people-list-header"> <h2 class="ng-binding"> Best Friends<span ng-show="library.numOfFriends !== null" class="friends-count ng-binding">(...)</span> </h2> <span ng-show="layout.invalidPresenceData" class="presence-error ng-hide"> <span class="icon-warning"></span> <span class="text-error ng-binding" ng-bind="'Label.PresenceError' | translate">User status may not be up to date</span> </span> <a class="btn-secondary-xs btn-more see-all-link-icon ng-binding" id="best-friend-expand-more">Expand</a> </div> <div class="section-content remove-panel people-list"> <p ng-show="layout.friendsError" class="section-content-off ng-binding ng-hide" ng-bind="'Label.FriendsError' | translate">Unable to load friends</p> <ul class="hlist" ng-controller="friendsListController" people-list="" ng-class="{'invisible': !layout.isAllFriendsDataLoaded}">  </ul> <span class="spinner spinner-default ng-hide" ng-show="!layout.isAllFriendsDataLoaded"></span> </div> </div> </div> <div class="col-xs-12 people-list-container ng-hide" ng-hide="layout.isAllFriendsDataLoaded"> <div class="section home-friends"> <div class="container-header people-list-header"> <h2 class="ng-binding">Friends</h2> </div> <div class="section-content remove-panel people-list"> <span class="spinner spinner-default"></span> </div> </div> </div>`;const w=o.getElementsByClassName("btn-more")[0],h=o.getElementsByClassName("hlist")[0];let b=localStorage.getItem("roqol-bestfriends-expanded")=="true",E=!1;function I(){E||!b?(o.style="height: 190px !important;",o.getElementsByClassName("people-list-container")[0].style="height: 190px !important; overflow: hidden;",o.getElementsByClassName("people-list")[0].style="height: 163px !important; max-height: 163px !important;",o.classList.remove("expand")):(o.style="",o.getElementsByClassName("people-list-container")[0].style="",o.getElementsByClassName("people-list")[0].style="",o.classList.add("expand")),w.innerText=b?"Retract":"Expand"}const F=document.createElement("style");F.innerHTML=` #best-friend-list-container.expand:not(.roblox-usernames) .people-list {height: 280px !important; max-height: 280px !important;} #best-friend-list-container.expand:not(.roblox-usernames) .people-list-container {height: 340px !important;}
    #best-friend-list-container.expand.roblox-usernames .people-list {height: 297px !important; max-height: 297px !important;} #best-friend-list-container.expand.roblox-usernames .people-list-container {height: 367px !important;}`,WaitForTag("body").then(function(n){n.appendChild(F)}),w.addEventListener("click",function(){b=!b,localStorage.setItem("roqol-bestfriends-expanded",b),I()});function x(){o.getElementsByClassName("friends-count")[0].innerText=`(${r.length}/${z})`,h.children.length===0||h.getBoundingClientRect().height===h.children[0].getBoundingClientRect().height?(E=!0,w.style.display="none"):(E=!1,w.style.display=""),I()}x(),window.addEventListener("resize",x);let N=!1,$=!1,k=!1;function U(){!k&&N&&$&&(k=!0,document.dispatchEvent(new CustomEvent("RobloxQoL.BestFriendsLoaded")))}WaitForId("HomeContainer").then(function(n){WaitForId("people-list-container").then(function(a){n.insertBefore(o,a),N=!0,U()})});const v={},L={},C={},m={};async function G(n){for(;m[n]===!0;)await sleep(0);if(m[n])return m[n];m[n]=!0;const[a,e]=await RequestFunc(`https://thumbnails.roblox.com/v1/games/icons?universeIds=${n}&returnPolicy=PlaceHolder&size=150x150&format=Png&isCircular=false`,"GET",void 0,void 0,!0);return a?m[n]=e.data[0].imageUrl:m[n]="https://tr.rbxcdn.com/53eb9b17fe1432a809c73a13889b5006/420/420/Image/Png",m[n]}let g=[];function H(n){return new Promise(async(a,e)=>{if(C[n])return a(C[n]);if(g.push({resolve:a,reject:e,universeId:n}),g.length!==1)return;g.length>50&&(g=[]);const t=g;await sleep(50),g=[];const s=[],l={};for(let u=0;u<t.length;u++){const c=t[u];l[c.universeId]||(s.push(c.universeId),l[c.universeId]=[]),l[c.universeId].push(c)}const[d,y]=await RequestFunc(`https://games.roblox.com/v1/games/multiget-place-details?placeIds=${s.join("&placeIds=")}`,"GET",void 0,void 0,!0);if(!d){for(i=0;i<t.length;i++)t[i].resolve();return}const A=y;for(let u=0;u<A.length;u++){const c=A[u];C[c.placeId]=c;const j=l[c.placeId];for(let B=0;B<j.length;B++)j[B].resolve(c)}})}function Q(n){const a=v[n];if(!a)return;const e=document.createElement("div");e.setAttribute("uib-popover-template-popup",""),e.setAttribute("uib-title",""),e.className="popover ng-scope ng-isolate-scope bottom people-info-card-container card-with-game fade in",e.style="top: 550px; left: 72px;",e.innerHTML=`<div class="arrow"></div>

        <div class="popover-inner">
            <!-- ngIf: uibTitle -->
            <div class="popover-content" uib-tooltip-template-transclude="contentExp()" tooltip-template-transclude-scope="originScope()"><div ng-controller="peopleInfoCardController" ng-class="{'card-with-game': friend.presence.placeUrl}" class="ng-scope card-with-game"> <div class="border-bottom place-container" ng-show="friend.presence.placeUrl" style="
            /* display: none; */
        "> <a href="" class="game-link"> <thumbnail-2d class="cursor-pointer place-icon ng-isolate-scope" thumbnail-type="layout.thumbnailTypes.gameIcon" thumbnail-target-id="library.placesDict[friend.presence.rootPlaceId].universeId"><span ng-class="$ctrl.getCssClasses()" class="thumbnail-2d-container" thumbnail-type="GameIcon" thumbnail-target-id="2324018757"> <!-- ngIf: $ctrl.thumbnailUrl && !$ctrl.isLazyLoadingEnabled() --><img ng-if="$ctrl.thumbnailUrl &amp;&amp; !$ctrl.isLazyLoadingEnabled()" ng-src="https://tr.rbxcdn.com/624b92c3b39e5fa6a7c41db0a95718a7/150/150/Image/Png" thumbnail-error="$ctrl.setThumbnailLoadFailed" ng-class="{'loading': $ctrl.thumbnailUrl &amp;&amp; !isLoaded }" image-load="" alt="" title="" class="ng-scope ng-isolate-scope game-image" src=""><!-- end ngIf: $ctrl.thumbnailUrl && !$ctrl.isLazyLoadingEnabled() --> <!-- ngIf: $ctrl.thumbnailUrl && $ctrl.isLazyLoadingEnabled() --> </span> </thumbnail-2d> </a> <div class="place-info-container"> <div class="place-info"> <a href="https://www.roblox.com/games/6298464951/gamename" class="text-subject cursor-pointer place-title ng-binding" ng-bind="library.placesDict[friend.presence.rootPlaceId].name" ng-click="goToGameDetails('link')"></a> <div class="icon-text-wrapper ng-hide" ng-show="library.placesDict[friend.presence.rootPlaceId].requiredPurchase"> <span class="icon-robux"></span> <span class="text-robux ng-binding" ng-bind="library.placesDict[friend.presence.rootPlaceId].price">0</span> </div> </div> <div class="place-btn-container"> <button class="btn-full-width place-btn btn-growth-sm join-button" ng-click="clickBtn('btn')"> Join </button> </div> </div> </div> <ul class="dropdown-menu interaction-container"> <li class="interaction-item chat-with-button" ng-click="goToChat()"> <span class="icon icon-chat-gray"></span> <span class="text-overflow border-bottom label ng-binding chat-with-user" ng-bind="layout.interactionLabels.chat(friend.nameToDisplay)" title="Chat with BinglyWingly">Chat with BinglyWingly</span> </li> <li class="interaction-item go-to-profile-page" ng-click="goToProfilePage()"> <span class="icon icon-viewdetails"></span> <span class="label ng-binding" ng-bind="layout.interactionLabels.viewProfile">View Profile</span> </li> </ul> </div></div>
        </div>`,a.userPresenceType===2&&a.lastLocation?(e.getElementsByClassName("game-link")[0].href=`https://www.roblox.com/games/${a.rootPlaceId}/`,e.getElementsByClassName("place-title")[0].href=`https://www.roblox.com/games/${a.rootPlaceId}/`,e.getElementsByClassName("place-title")[0].innerText=a.lastLocation,G(a.universeId).then(function(s){e.getElementsByClassName("game-image")[0].src=s}),H(a.rootPlaceId).then(function(s){e.getElementsByClassName("icon-text-wrapper")[0].className="icon-text-wrapper ng-hide";const l=e.getElementsByClassName("place-btn")[0];s&&s.isPlayable?l.addEventListener("click",function(){document.dispatchEvent(new CustomEvent("RobloxQoL.launchGame",{detail:v[n]}))}):(l.className="btn-full-width place-btn btn-control-sm",l.innerText="View Details",l.addEventListener("click",function(){window.location.href=`https://www.roblox.com/games/${a.rootPlaceId}/`}),s.reasonProhibited==="PurchaseRequired"&&s.price&&(e.getElementsByClassName("text-robux")[0].innerText=s.price,e.getElementsByClassName("icon-text-wrapper")[0].className="icon-text-wrapper"))})):e.getElementsByClassName("place-container")[0].remove();const t=L[n];return e.getElementsByClassName("chat-with-user")[0].title=`Chat with ${t?t.nameToDisplay||t.displayName:"???"}`,e.getElementsByClassName("chat-with-user")[0].innerText=`Chat with ${t?t.nameToDisplay||t.displayName:"???"}`,e.getElementsByClassName("go-to-profile-page")[0].addEventListener("click",function(){window.location.href=`https://www.roblox.com/users/${n}/profile`}),e.getElementsByClassName("chat-with-button")[0].addEventListener("click",function(){document.dispatchEvent(new CustomEvent("RobloxQoL.OpenFriendChatConversation",{detail:n}))}),document.body.appendChild(e),e}let p;function M(n){if(!p)return;const a=n.getBoundingClientRect();p.style=`top: ${a.top+84*1.5+4+window.scrollY}px; left: ${a.left-320/3}px;`}async function R(){if(!p)return;const n=p;p=null,n.className="popover ng-scope ng-isolate-scope bottom people-info-card-container card-with-game fade",await sleep(1e3),n.remove()}const f={};function P(){function n(e){return e===2?3:e===3?2:e}const a=r.slice();a.sort(function(e,t){const s=v[e],l=v[t],d=n(s?.userPresenceType||0);return n(l?.userPresenceType||0)-d});for(let e=0;e<a.length;e++){const t=a[e],s=f[t];s?.parentNode&&h.appendChild(s)}}function V(n){const a=document.createElement("li");a.id="best-friend-"+n,a.className="list-item friend best-friend-item ng-scope",a.setAttribute("rbx-user-id",n),a.innerHTML=`<div people="" class="ng-scope"> <div class="avatar-container"> <a href="" class="text-link friend-link ng-isolate-scope" ng-click="clickAvatar(friend, $index)" popover-trigger=" 'none' " popover-class="people-info-card-container card-with-game best-friend-people-info-37270727" popover-placement="bottom" popover-append-to-body="true" popover-is-open="hoverPopoverParams.isOpen" hover-popover-params="hoverPopoverParams" hover-popover="" uib-popover-template="'people-info-card'"> <div class="avatar avatar-card-fullbody"> <span class="avatar-card-link friend-avatar icon-placeholder-avatar-headshot" ng-class="{'icon-placeholder-avatar-headshot': !friend.avatar.imageUrl}"> <thumbnail-2d class="avatar-card-image ng-isolate-scope" thumbnail-type="layout.thumbnailTypes.avatarHeadshot" thumbnail-target-id="friend.id"><span ng-class="$ctrl.getCssClasses()" class="thumbnail-2d-container" thumbnail-type="AvatarHeadshot" thumbnail-target-id="37270727"> <!-- ngIf: $ctrl.thumbnailUrl && !$ctrl.isLazyLoadingEnabled() --><img ng-if="$ctrl.thumbnailUrl &amp;&amp; !$ctrl.isLazyLoadingEnabled()" thumbnail-error="$ctrl.setThumbnailLoadFailed" ng-class="{'loading': $ctrl.thumbnailUrl &amp;&amp; !isLoaded }" image-load="" alt="" title="" class="ng-scope ng-isolate-scope"><!-- end ngIf: $ctrl.thumbnailUrl && !$ctrl.isLazyLoadingEnabled() --> <!-- ngIf: $ctrl.thumbnailUrl && $ctrl.isLazyLoadingEnabled() --> </span> </thumbnail-2d> </span> </div> <div ng-class="{'shimmer': layout.namesLoading}" class="friend-parent-container"> <div class="friend-name-container"> <span class="text-overflow friend-name font-caption-header ng-binding" ng-bind="friend.nameToDisplay" title=""></span> <span ng-class="{'hide': !friend.hasVerifiedBadge || layout.namesLoading}" class="verified-badge hide"> <span><span role="button" tabindex="0" data-rblx-verified-badge-icon="" data-rblx-badge-icon="true" class="jss4"><img class="verified-badge-icon-friends-carousel-rendered" src="data:image/svg+xml;charset=utf-8,%3Csvg xmlns='http://www.w3.org/2000/svg' width='28' height='28' viewBox='0 0 28 28' fill='none'%3E%3Cg clip-path='url(%23clip0_8_46)'%3E%3Crect x='5.88818' width='22.89' height='22.89' transform='rotate(15 5.88818 0)' fill='%230066FF'/%3E%3Cpath fill-rule='evenodd' clip-rule='evenodd' d='M20.543 8.7508L20.549 8.7568C21.15 9.3578 21.15 10.3318 20.549 10.9328L11.817 19.6648L7.45 15.2968C6.85 14.6958 6.85 13.7218 7.45 13.1218L7.457 13.1148C8.058 12.5138 9.031 12.5138 9.633 13.1148L11.817 15.2998L18.367 8.7508C18.968 8.1498 19.942 8.1498 20.543 8.7508Z' fill='white'/%3E%3C/g%3E%3Cdefs%3E%3CclipPath id='clip0_8_46'%3E%3Crect width='28' height='28' fill='white'/%3E%3C/clipPath%3E%3C/defs%3E%3C/svg%3E" title="Verified Badge Icon" alt="Verified Badge Icon"></span></span> </span> </div> </div> <!-- ngIf: friend.presence.placeUrl --><div class="text-overflow xsmall text-label place-name ng-binding ng-scope" style="display: hidden;" ng-if="friend.presence.placeUrl" ng-bind="library.placesDict[friend.presence.rootPlaceId].name"></div><!-- end ngIf: friend.presence.placeUrl --> </a> <!-- ngIf: friend.presence.placeUrl --><a class="friend-status place-link ng-scope" ng-href="https://www.roblox.com/games/147848991/gamename" ng-if="friend.presence.placeUrl" ng-click="clickPlaceLink(friend, $index)" href="https://www.roblox.com/games/147848991/gamename"> <span class="avatar-status friend-status icon-game" style="display: none;" title="Be A Parkour Ninja"></span> </a></div> </div>`,a.getElementsByClassName("friend-link")[0].href=`https://www.roblox.com/users/${n}/profile`;let e=!1,t=!1;function s(){!t&&!e&&R()}return a.addEventListener("mouseenter",async function(){t=!0,e=!1,R(),await sleep(0),p=Q(n),p.addEventListener("mouseenter",function(){e=!0}),p.addEventListener("mouseleave",function(){e=!1,s()}),M(a)}),a.addEventListener("mouseleave",async function(){await sleep(0),t=!1,s()}),a}for(let n=0;n<r.length;n++){const a=r[n],e=V(a);f[a]=e}P(),x(),RequestFunc("https://thumbnails.roblox.com/v1/users/avatar-headshot?size=150x150&format=Png&isCircular=true&userIds="+r.join(","),"GET",void 0,void 0,!0).then(function([n,a]){if(!n)return;const e=a.data;for(let t=0;t<e.length;t++)f[e[t].targetId].getElementsByClassName("thumbnail-2d-container")[0].getElementsByTagName("img")[0].src=e[t].imageUrl});let D;RequestFunc("https://users.roblox.com/v1/users","POST",{"Content-Type":"application/json"},JSON.stringify({userIds:r,excludeBannedUsers:!1}),!0).then(async function([n,a]){if(!n)return;const e=a.data;for(let t=0;t<e.length;t++){const s=e[t];L[s.id]=s}await Promise.race([new Promise(async t=>{function s(l){for([UserId,Tag]of Object.entries(l.detail))L[UserId].nameToDisplay=Tag;document.removeEventListener("RobloxQoL.BestFriendsTags",s),t()}for(document.addEventListener("RobloxQoL.BestFriendsTags",s);!D?.getAttribute("ready");)await sleep(100);document.dispatchEvent(new CustomEvent("RobloxQoL.BestFriendsTagsRequest",{detail:JSON.stringify(r)}))}),sleep(1e3)]);for(let t=0;t<e.length;t++){const s=e[t],l=f[s.id],d=l.getElementsByClassName("friend-name")[0];d.title=s.nameToDisplay||s.displayName,d.innerText=s.nameToDisplay||s.displayName;const y=l.getElementsByClassName("verified-badge")[0];s.hasVerifiedBadge&&(y.className=y.className.replace("hide",""))}});function S(n){const a=n.userId||n.id,e=n.presence||n;v[a]=e;const t=f[a];if(!t)return;const s=t.getElementsByClassName("avatar-status")[0];e.userPresenceType!==0?(s.style.display="",s.title=e.lastLocation,s.className=`avatar-status friend-status icon-${e.userPresenceType===1&&"online"||e.userPresenceType===2&&"game"||e.userPresenceType===3&&"studio"||""}`,t.getElementsByClassName("friend-status place-link")[0].href=e.rootPlaceId?`https://www.roblox.com/games/${e.rootPlaceId}/`:"",t.getElementsByClassName("text-label place-name")[0].innerText=e.userPresenceType===2?e.lastLocation:""):s.style.display="none"}document.addEventListener("Roblox.Presence.Update",async function(n){S(n.detail[0]),P()}),document.addEventListener("RobloxQoL.BestFriendsPresenceUpdate",function(n){const a=n.detail,e={};for(let t=0;t<a.length;t++){const s=a[t],l=s.userId||s.id;S(s);const d=f[l];d&&h.appendChild(d),e[l]=!0}for(let t=0;t<r.length;t++){const s=r[t];e[s]||(r.splice(t,1),t--,RequestFunc(WebServerEndpoints.BestFriends+"pin","POST",{"Content-Type":"application/json"},JSON.stringify({Pinned:!1,UserId:s})))}x(),P(),$=!0,U()}),D=await InjectScript("BestFriendsPresenceUpdate")});

//# sourceMappingURL=https://roqol.io/assets/sourcemap/chrome/2.33.1/js/pages/bestfriend/home.js