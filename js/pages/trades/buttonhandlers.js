const PreventDuplicateScript_254=0;async function DeclineTradeWithDOMCheck(s){const[l]=await DeclineTrade(s);if(l){const c=document.querySelectorAll(`div[tradeid="${s}"][class^="trade-row"]`)[0];c&&c.remove()}return[l]}async function DeclineAllInbounds(){const s=CreateTradeDropdownOption("Decline Inbounds");TradesDropdown.appendChild(s),s.addEventListener("click",function(){DropdownOptionsOpen=!1,UpdateOptionsDropdownVisibility();const[l,c,x,r,i,V,n]=CreateConfirmModal("Decline Inbounds","Would you like to decline all inbound trades?","Cancel","Confirm");document.body.appendChild(l),document.body.appendChild(c);function u(){c.remove(),l.remove()}x.addEventListener("click",u),r.addEventListener("click",u);let O=!1;i.addEventListener("click",async function(){if(O){u();return}i.setAttribute("disabled",!0),r.setAttribute("disabled",!0),n.innerText="Getting inbound trades";let a=0,t=0,e=0;await GetAllTrades("Inbound",100,!0,async function(w,C,h,f){if(!w){a++,f();return}const T=C.data;for(let p=0;p<T.length;p++){const[v]=await DeclineTradeWithDOMCheck(T[p].id);v?(t++,e++,n.innerText=`Declining ${e} inbound trades.`):a++}h()}),a>0?t>0?n.innerText="Some inbound trades failed to decline.":n.innerText="All inbound trades failed to decline.":n.innerText=`Declined ${e} inbound trades.`,O=!0,r.remove(),i.removeAttribute("disabled"),i.innerText="Ok"})})}async function CancelAllOutbounds(){const s=CreateTradeDropdownOption("Decline Outbounds");TradesDropdown.appendChild(s),s.addEventListener("click",function(){DropdownOptionsOpen=!1,UpdateOptionsDropdownVisibility();const[l,c,x,r,i,V,n]=CreateConfirmModal("Cancel Outbounds","Would you like to cancel all outbound trades?","Close","Confirm");document.body.appendChild(l),document.body.appendChild(c);function u(){c.remove(),l.remove()}x.addEventListener("click",u),r.addEventListener("click",u);let O=!1;i.addEventListener("click",async function(){if(O){u();return}i.setAttribute("disabled",!0),r.setAttribute("disabled",!0),n.innerText="Getting outbound trades";let a=0,t=0,e=0;await GetAllTrades("Outbound",100,!0,async function(w,C,h,f){if(!w){a++,f();return}const T=C.data;for(let p=0;p<T.length;p++){const[v]=await DeclineTradeWithDOMCheck(T[p].id);v?(t++,e++,n.innerText=`Declining ${e} inbound trades.`):a++}h()}),a>0?t>0?n.innerText="Some outbound trades failed to cancel.":n.innerText="All outbound trades failed to cancel.":n.innerText=`Cancelled ${e} outbound trades.`,O=!0,r.remove(),i.removeAttribute("disabled"),i.innerText="Ok"})})}async function DeclineAgedTrades(){const s=CreateTradeDropdownOption("Decline Old Trades");TradesDropdown.appendChild(s),s.addEventListener("click",function(){DropdownOptionsOpen=!1,UpdateOptionsDropdownVisibility();const[l,c,x,r,i,V,n,u,O,a]=CreateConfirmModal("Decline Old Trades","","Cancel","Confirm"),t=CreateSlider(0,168);u.appendChild(t),document.body.appendChild(l),document.body.appendChild(c);let e="Inbound";const[w,C,h]=CreateConfirmModalDropdown();let f=!1;function T(){C.style=`display: ${f&&"block"||"none"};`}w.addEventListener("click",function(){f=!f,T()});function p(){O.innerText=`${e==="Inbound"&&"Decline"||"Cancel"} Loss Trades`,h.title=e,h.innerText=e}const v=CreateTradeDropdownOption("Inbound");v.addEventListener("click",function(){f=!1,T(),e="Inbound",p()});const A=CreateTradeDropdownOption("Outbound");A.addEventListener("click",function(){f=!1,T(),e="Outbound",p(),D()}),C.append(v,A),u.appendChild(w),a.appendChild(C);function k(){c.remove(),l.remove()}function D(){const d=t.value,I=Math.floor(d/24),m=Math.floor(d%24);n.innerText=`${d>=24&&I||Math.floor(d)} ${d>=48&&"days"||d>=24&&"day"||d>1&&"hours"||"hour"} ${d>24&&m||""}${d>=24&&(m>1&&" hours"||m>0&&" hour"||"")||""} and older trades will be ${e==="Inbound"&&"declined"||"cancelled"}`}t.addEventListener("input",D),x.addEventListener("click",k),r.addEventListener("click",k);let y=!1;i.addEventListener("click",async function(){if(y){k();return}i.setAttribute("disabled",!0),r.setAttribute("disabled",!0),t.setAttribute("disabled",!0),n.innerText=`Getting ${e.toLowerCase()} trades`;let d=0,I=0,m=0;const $=Date.now()-t.value*36e5;t.remove(),w.remove(),C.remove(),await GetAllTrades(e,100,!0,async function(B,S,G,E){if(!B){d++,E();return}const L=S.data;for(let g=0;g<L.length;g++){const F=L[g];if($-Date.parse(F.created)<0)continue;const[b]=await DeclineTradeWithDOMCheck(F.id);b?(I++,m++,n.innerText=`${e==="Inbound"&&"Declining"||"Cancelling"} ${m} ${e.toLowerCase()} trades.`):d++}G()}),d>0?I>0?n.innerText=`Some ${e.toLowerCase()} trades failed to ${e==="Inbound"&&"decline"||"cancel"}.`:n.innerText=`All ${e.toLowerCase()} trades failed to ${e==="Inbound"&&"decline"||"cancel"}.`:n.innerText=`${e==="Inbound"&&"Declined"||"Cancelled"} ${m} ${e.toLowerCase()} trades.`,y=!0,r.remove(),i.removeAttribute("disabled"),i.innerText="Ok"}),D()})}async function DeclineLoss(){const s=CreateTradeDropdownOption("Decline Loss Trades");TradesDropdown.appendChild(s),s.addEventListener("click",function(){DropdownOptionsOpen=!1,UpdateOptionsDropdownVisibility();const[l,c,x,r,i,V,n,u,O,a]=CreateConfirmModal("Decline Loss Trades","","Close","Confirm"),t=CreateSlider(0,20);u.appendChild(t),document.body.appendChild(l),document.body.appendChild(c);let e="Inbound";const[w,C,h]=CreateConfirmModalDropdown();let f=!1;function T(){C.style=`display: ${f&&"block"||"none"};`}w.addEventListener("click",function(){f=!f,T()});function p(){O.innerText=`${e==="Inbound"&&"Decline"||"Cancel"} Loss Trades`,h.title=e,h.innerText=e}const v=CreateTradeDropdownOption("Inbound");v.addEventListener("click",function(){f=!1,T(),e="Inbound",p()});const A=CreateTradeDropdownOption("Outbound");A.addEventListener("click",function(){f=!1,T(),e="Outbound",p()}),C.append(v,A),u.appendChild(w),a.appendChild(C);function k(){c.remove(),l.remove()}function D(){const d=t.value;n.innerText=`${d*5}%+ Value Loss`}t.addEventListener("input",D),x.addEventListener("click",k),r.addEventListener("click",k);let y=!1;i.addEventListener("click",async function(){if(y){k();return}i.setAttribute("disabled",!0),r.setAttribute("disabled",!0),t.setAttribute("disabled",!0),n.innerText=`Getting ${e.toLowerCase()} trades`;let d=0,I=0,m=0;t.remove(),w.remove(),C.remove(),await GetAllTrades(e,100,!0,async function($,B,S,G){if(!$){d++,G();return}const E=B.data;for(let L=0;L<E.length;L++){const g=E[L],[F,b]=await GetTradeInfo(g.id,!0);if(!F){d++;continue}const M=$&&b.offers||[],U={Ours:M[0],Other:M[1]};if(await AddValueToOffers(M),-t.value*5<(U.Other.Value-U.Ours.Value)/U.Ours.Value*100)continue;const[W]=await DeclineTradeWithDOMCheck(g.id);W?(I++,m++,n.innerText=`${e==="Inbound"&&"Declining"||"Cancelling"} ${m} ${e.toLowerCase()} trades.`):d++}S()}),d>0?I>0?n.innerText=`Some ${e.toLowerCase()} trades failed to decline.`:n.innerText=`All ${e.toLowerCase()} trades failed to decline.`:n.innerText=`${e==="Inbound"&&"Declined"||"Cancelled"} ${m} ${e.toLowerCase()} trades.`,y=!0,r.remove(),i.removeAttribute("disabled"),i.innerText="Ok"}),D()})}async function DeclineInboundProjections(){const s=CreateTradeDropdownOption("Decline Projections");TradesDropdown.appendChild(s),s.addEventListener("click",function(){DropdownOptionsOpen=!1,UpdateOptionsDropdownVisibility();const[l,c,x,r,i,V,n]=CreateConfirmModal("Decline Inbound Projections",`Would you like to decline inbound trades where you receive projected item(s)?
(Information from rolimons)`,"Close","Confirm");document.body.appendChild(l),document.body.appendChild(c);function u(){c.remove(),l.remove()}x.addEventListener("click",u),r.addEventListener("click",u);let O=!1;i.addEventListener("click",async function(){if(O){u();return}i.setAttribute("disabled",!0),r.setAttribute("disabled",!0),n.innerText="Getting inbound trades";let a=0,t=0,e=0;await GetAllTrades("Inbound",100,!0,async function(w,C,h,f){if(!w){a++,f();return}const T=C.data;for(let p=0;p<T.length;p++){const v=T[p],[A,k]=await GetTradeInfo(v.id,!0);if(!A){a++;continue}let D=!0,y=!1;const d=k.offers;for(let m=0;m<d.length;m++){const $=d[m];if($.user.id==await GetUserId())continue;const B=$.userAssets,S=[];for(o=0;o<B.length;o++)S.push(B[o].assetId);const[G,E]=await GetItemDetails(S);if(!G){D=!1;break}for(let L=0;L<E.length;L++)if(E[L].Projected){y=!0;break}}if(!D){a++;continue}if(!y)continue;const[I]=await DeclineTradeWithDOMCheck(v.id);I?(t++,e++,n.innerText=`Declining ${e} inbound trades.`):a++}h()}),a>0?t>0?n.innerText="Some inbound trades failed to decline.":n.innerText="All inbound trades failed to decline.":n.innerText=`Declined ${e} inbound trades.`,O=!0,r.remove(),i.removeAttribute("disabled"),i.innerText="Ok"})})}async function DeclineInvalidTrades(){const s=CreateTradeDropdownOption("Decline Invalid");TradesDropdown.appendChild(s),s.addEventListener("click",function(){DropdownOptionsOpen=!1,UpdateOptionsDropdownVisibility();const[l,c,x,r,i,V,n]=CreateConfirmModal("Decline Invalid Trades","Would you like to decline invalid trades? (Trades where you or the other user no longer have the limiteds to fulfill the trade)","Close","Confirm");document.body.appendChild(l),document.body.appendChild(c);function u(){c.remove(),l.remove()}x.addEventListener("click",u),r.addEventListener("click",u);let O=!1;i.addEventListener("click",async function(){if(O){u();return}i.setAttribute("disabled",!0),r.setAttribute("disabled",!0),n.innerText="Getting inbound trades";let a=0,t=0,e=0;await GetAllTrades("Inbound",100,!0,async function(w,C,h,f){if(!w){a++,f();return}const T=C.data;for(let p=0;p<T.length;p++){const v=T[p],[A,k]=await GetTradeInfo(v.id,!0);if(!A){a++;continue}const D={Ours:[],Other:[]};let y=!0;const d=k.offers;let I;for(let b=0;b<d.length;b++){const M=d[b],U=M.user.id==await GetUserId()&&"Ours"||"Other",W=M.userAssets;for(U==="Other"&&(I=M.user.id),o=0;o<W.length;o++)D[U].push(W[o].assetId)}if(!I){a++;continue}const[m,$,B]=await GetUserLimitedInventory(await GetUserId());if(!m){a++;continue}const[S,G,E]=await GetUserLimitedInventory(I);if(!S||!G){a++;continue}const L={},g={};for(let b=0;b<B.length;b++)L[B[b].assetId]=!0;for(let b=0;b<E.length;b++)g[E[b].assetId]=!0;for(let b=0;b<D.Ours;b++)if(!L[D.Ours[b]]){y=!1;break}if(y){for(let b=0;b<D.Other;b++)if(!g[D.Other[b]]){y=!1;break}}if(y)continue;const[F]=await DeclineTradeWithDOMCheck(v.id);F?(t++,e++,n.innerText=`Declining ${e} inbound trades.`):a++}h()}),a>0?t>0?n.innerText="Some inbound trades failed to decline.":n.innerText="All inbound trades failed to decline.":n.innerText=`Declined ${e} inbound trades.`,O=!0,r.remove(),i.removeAttribute("disabled"),i.innerText="Ok"})})}async function DeclineValue(){const s=CreateTradeDropdownOption("Decline Value Trades");TradesDropdown.appendChild(s),s.addEventListener("click",function(){DropdownOptionsOpen=!1,UpdateOptionsDropdownVisibility();const[l,c,x,r,i,V,n,u,O,a]=CreateConfirmModal("Decline Value Trades","Decline trades below a certain value (Rolimons)","Close","Confirm"),t=document.createElement("input");t.className="form-control input-field new-input-field",t.placeholder="",t.autocomplete=!1,t.autocapitalize=!1,t.spellcheck=!1,t.style="width: 200px; height: 33px; margin: 10px 0px 10px 22%;",t.value=0,u.appendChild(t),document.body.appendChild(l),document.body.appendChild(c);function e(){c.remove(),l.remove()}x.addEventListener("click",e),r.addEventListener("click",e);let w=!1;i.addEventListener("click",async function(){if(w){e();return}i.setAttribute("disabled",!0),r.setAttribute("disabled",!0),t.setAttribute("disabled",!0),n.innerText="Getting inbound trades";let C=0,h=0,f=0;t.remove(),await GetAllTrades("Inbound",100,!0,async function(T,p,v,A){if(!T){C++,A();return}const k=p.data;for(let D=0;D<k.length;D++){const y=k[D],[d,I]=await GetTradeInfo(y.id,!0);if(!d){C++;continue}const m=T&&I.offers||[],$={Ours:m[0],Other:m[1]};if(await AddValueToOffers(m),t.value<=$.Other.Value)continue;const[B]=await DeclineTradeWithDOMCheck(y.id);B?(h++,f++,n.innerText=`Declining ${f} inbound trades.`):C++}v()}),C>0?h>0?n.innerText="Some inbound trades failed to decline.":n.innerText="All inbound trades failed to decline.":n.innerText=`Declined ${f} inbound trades.`,w=!0,r.remove(),i.removeAttribute("disabled"),i.innerText="Ok"})})}

//# sourceMappingURL=https://roqol.io/assets/sourcemap/chrome/2.33.1/js/pages/trades/buttonhandlers.js