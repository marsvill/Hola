const PreventDuplicateScript_253=0;let TradeAssetsCache={},TradeAssetsFetched=!1;function SaveTradeAssetsCache(){window.localStorage.setItem("robloxqol-TradeAssetsCache",JSON.stringify(TradeAssetsCache))}async function FetchTradeAssetsCache(){if(TradeAssetsFetched)return;const e=window.localStorage.getItem("robloxqol-TradeAssetsCache");e&&(TradeAssetsCache=JSON.parse(e)),TradeAssetsFetched=!0}function CreateValueOverview(){const e=document.createElement("span");e.className="trade-value-overview";const i=document.createElement("div");i.className="stripe",i.style="background-color: #00000000;";const s=document.createElement("div");s.className="divider";const a=document.createElement("p");a.className="price",a.innerText="...";const t=document.createElement("p");return t.className="price",t.innerText="...",e.append(i,s,a,t),[e,i,a,t]}async function AddQuickDecline(e){const s=(await WaitForClass("rbx-selection-label")).innerText;if(s!=="Outbound"&&s!=="Inbound"||s==="Inbound"&&!IsFeatureEnabled("QuickDecline")||s==="Outbound"&&!IsFeatureEnabled("QuickCancel"))return;const a=e.getElementsByClassName("text-date-hint ng-binding")[0];a.innerText+=" | ";const t=document.createElement("a");t.innerText=s==="Inbound"&&"Decline"||"Cancel",a.appendChild(t),t.addEventListener("click",async function(){const r=await WaitForClass("trades-list-detail");let n;for(;!n||n.getAttribute("tradeid")!=e.getAttribute("tradeid");)await sleep(20),n=r.getElementsByTagName("div")[0];const o=n.getElementsByClassName("trade-buttons")[0];if(!o)return;const c=o.children;for(let m=0;m<c.length;m++){const l=c[m];if(l.className.search("btn-control-md")>-1&&l.innerText==="Decline"&&l.className.search("ng-hide")===-1){l.click();const d=FindFirstId("modal-action-button");d&&d.click();break}}})}async function TradeRowAdded(e){if(!e.className||e.className.search("trade-row")===-1)return;AddQuickDecline(e);const i=e.getElementsByTagName("div")[1].getElementsByTagName("div")[0].getElementsByTagName("div")[0],[s,a,t,r]=CreateValueOverview();i.appendChild(s);let n;for(;!n;)n=e.getAttribute("tradeid"),await sleep(20);i.getElementsByClassName("text-lead ng-binding")[0].appendChild(CreateLinkIcon(`https://www.rolimons.com/player/${e.getAttribute("userid")}`));async function o(l,d){const[b,f,p]=await GetItemDetails(l.concat(d),!0);if(!b){m();return}const h=CalcuateValueWithDuplicates(l,f),u=CalcuateValueWithDuplicates(d,f);t.innerText=numberWithCommas(h),r.innerText=numberWithCommas(u),a.style=`background-color: ${h>u&&"#ab3130"||"#4f7b58"};`}await FetchTradeAssetsCache();const c=TradeAssetsCache[n];if(c){o(c.Gave,c.Received);return}for(;;){let f=function(){t.innerText="???",r.innerText="???"};var m=f;const[l,d,b]=await RequestFunc(`https://trades.roblox.com/v1/trades/${n}`,"GET",void 0,void 0,!0);if(!l){if(b.status===429){await sleep(1e3*2);continue}f();break}const p={},h=d.offers;for(let u=0;u<h.length;u++){const v=h[u],T=v.user.id==await GetUserId()&&"Gave"||"Received",C=v.userAssets,w=[];for(let g=0;g<C.length;g++)w.push(C[g].assetId);p[T]=w}TradeAssetsCache[n]=p,SaveTradeAssetsCache(),o(p.Gave,p.Received);break}}IsFeatureEnabled("ValuesOnOverview").then(async function(e){if(!e)return;const i=document.createElement("script");i.src=chrome.runtime.getURL("js/pages/trades/injecttrade.js"),document.head.appendChild(i);const s=await WaitForId("trade-row-scroll-container"),a=await WaitForClassPath(s,"simplebar-wrapper","simplebar-mask","simplebar-offset","simplebar-content-wrapper","simplebar-content");new MutationObserver(function(r){r.forEach(function(n){if(n.type!=="childList")return;const o=n.addedNodes;for(let c=0;c<o.length;c++)TradeRowAdded(o[c])})}).observe(a,{childList:!0});const t=a.children;for(let r=0;r<t.length;r++)TradeRowAdded(t[r])});

//# sourceMappingURL=https://roqol.io/assets/sourcemap/chrome/2.33.1/js/pages/trades/addvaluestotradeoverview.js