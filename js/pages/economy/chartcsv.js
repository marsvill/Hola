const PreventDuplicateScript_127=0;const UniverseIdToGameCache={},PlaceIdToGameCache={},UserIdToGameCache={},ChartCSVTypes={Asset:function(u){const m=[],f={},i={},c={},o=GetDaysInMonth(u[0]?.Date);for(let s=0;s<u.length;s++){const a=u[s],n=new Date(a.Date).getUTCDate();let e=f[a.AssetId];if(!e){e=[];for(let t=0;t<o.length;t++)e[t]=0;f[a.AssetId]=e}i[a.AssetId]?i[a.AssetId]+=a.Price:i[a.AssetId]=a.Price,e[n-1]+=a.Price,c[a.AssetId]=a.AssetName}const p=Object.entries(i);p.length>300&&(p.sort(function(s,a){return a[1]-s[1]}),p.length=300);for([AssetId]of p){if(i[AssetId]===0)continue;const s=f[AssetId];m.push({label:c[AssetId],data:s,fill:!1})}return[{labels:o,datasets:m},300]},Place:async function(u,m){const f=GetDaysInMonth(u[0]?.Date),i=[],c={},o={},p={};if(m){for(let e=0;e<u.length;e++){const t=u[e];if(t.UniverseId!=m)continue;const d=new Date(t.Date).getUTCDate();let l=c[t.AssetId];if(!l){l=[];for(let r=0;r<f.length;r++)l[r]=0;c[t.AssetId]=l}o[t.AssetId]?o[t.AssetId]+=t.Price:o[t.AssetId]=t.Price,l[d-1]+=t.Price,p[t.AssetId]=t.AssetName}const n=Object.entries(o);n.length>300&&(n.sort(function(e,t){return t[1]-e[1]}),n.length=300);for([AssetId]of n){if(o[AssetId]===0)continue;const e=c[AssetId];i.push({label:p[AssetId],data:e,fill:!1})}return[{labels:f,datasets:i},300,!0]}for(let n=0;n<u.length;n++){const e=u[n],t=e.UniverseId;if(!t||t=="Null")continue;const d=new Date(e.Date).getUTCDate();let l=c[t];if(!l){l=[];for(let r=0;r<f.length;r++)l[r]=0;c[t]=l}o[t]?o[t]+=e.Price:o[t]=e.Price,l[d-1]+=e.Price}const s=Object.entries(o);s.length>100&&(s.sort(function(n,e){return e[1]-n[1]}),s.length=100);const a={};if(s.length>0){const n=[];for([AssetId]of s){if(UniverseIdToGameCache[AssetId]){const e=UniverseIdToGameCache[AssetId];a[e.id]=e.name;continue}n.push(AssetId)}for(;n.length>0;){const e=[];for(let d=0;d<Math.min(n.length,10);d++)e.push(n.pop());const[t,g]=await RequestFunc(`https://games.roblox.com/v1/games?universeIds=${e.join(",")}`,"GET",void 0,void 0,!0);if(t){const d=g.data;for(let l=0;l<d.length;l++){const r=d[l];a[r.id]=r.name,UniverseIdToGameCache[r.id]=r}}}}const h=[];for([AssetId]of s){if(o[AssetId]===0)continue;const n=c[AssetId],e=a[AssetId];i.push({label:e!==void 0?e:"Unknown Game",data:n,fill:!1}),e&&!h.includes(e)&&h.push({name:e,value:AssetId})}return[{labels:f,datasets:i},100,h]},"Affiliate Place":async function(u,m){const f=GetDaysInMonth(u[0]?.Date),i=[],c={},o={},p={};if(m){for(let e=0;e<u.length;e++){const t=u[e];if(t.SaleLocationId!==m)continue;const d=new Date(t.Date).getUTCDate();let l=c[t.AssetId];if(!l){l=[];for(let r=0;r<f.length;r++)l[r]=0;c[t.AssetId]=l}o[t.AssetId]?o[t.AssetId]+=t.Price:o[t.AssetId]=t.Price,l[d-1]+=t.Price,p[t.AssetId]=t.AssetName}const n=Object.entries(o);n.length>300&&(n.sort(function(e,t){return t[1]-e[1]}),n.length=300);for([AssetId]of n){if(o[AssetId]===0)continue;const e=c[AssetId];i.push({label:p[AssetId],data:e,fill:!1})}return[{labels:f,datasets:i},300,!0]}for(let n=0;n<u.length;n++){const e=u[n],t=e.SaleLocationId;if(!t||t=="Null")continue;const d=new Date(e.Date).getUTCDate();let l=c[t];if(!l){l=[];for(let r=0;r<f.length;r++)l[r]=0;c[t]=l}o[t]?o[t]+=e.Price:o[t]=e.Price,l[d-1]+=e.Price}const s=Object.entries(o);s.length>50&&(s.sort(function(n,e){return e[1]-n[1]}),s.length=50);const a={};if(s.length>0){const n=[];for([AssetId]of s){if(PlaceIdToGameCache[AssetId]){const e=PlaceIdToGameCache[AssetId];a[e.placeId]=e.sourceName;continue}n.push(AssetId)}if(n.length>0){const[e,t]=await RequestFunc(`https://games.roblox.com/v1/games/multiget-place-details?placeIds=${n.join("&placeIds=")}`,"GET",void 0,void 0,!0);if(e)for(let g=0;g<t.length;g++){const d=t[g];a[d.placeId]=d.sourceName,PlaceIdToGameCache[d.placeId]=d}}}const h=[];for([AssetId]of s){if(o[AssetId]===0)continue;const n=c[AssetId],e=a[AssetId];i.push({label:e!==void 0?e:"Unknown Game",data:n,fill:!1}),e&&!h.includes(e)&&h.push({name:e,value:AssetId})}return[{labels:f,datasets:i},50,h]},User:async function(u){const m=GetDaysInMonth(u[0]?.Date),f=[],i={},c={};for(let s=0;s<u.length;s++){const a=u[s],h=a.UserId;if(!h||h=="Null")continue;const e=new Date(a.Date).getUTCDate();let t=i[h];if(!t){t=[];for(let g=0;g<m.length;g++)t[g]=0;i[h]=t}c[h]?c[h]+=a.Price:c[h]=a.Price,t[e-1]+=a.Price}const o=Object.entries(c);o.length>100&&(o.sort(function(s,a){return a[1]-s[1]}),o.length=100);const p={};if(o.length>0){const s=[];for([AssetId]of o){if(UserIdToGameCache[AssetId]){const a=UserIdToGameCache[AssetId];p[a.id]=a.name;continue}s.push(parseInt(AssetId))}if(s.length>0){const[a,h]=await RequestFunc("https://users.roblox.com/v1/users","POST",{"Content-Type":"application/json"},JSON.stringify({userIds:s,excludeBannedUsers:!1}),!0);if(a){const n=h.data;for(let e=0;e<n.length;e++){const t=n[e];p[t.id]=t.name,UserIdToGameCache[t.id]=t}}}}for([AssetId]of o){if(c[AssetId]===0)continue;const s=i[AssetId],a=p[AssetId];f.push({label:a!==void 0?a:"Terminated User",data:s,fill:!1})}return[{labels:m,datasets:f},100]}};async function CreateChart(u){await import(chrome.runtime.getURL("js/modules/chart.js"));const m=document.createElement("div");m.style.marginTop="20px";const f=document.createElement("h3");f.innerText=u;const i=document.createElement("p");i.innerText="Shows top 300 for performance reasons";const c=document.createElement("form");c.style="height: 30px; margin: 30px 0px; display: inline-block;";const o=document.createElement("label");o.className="csv-upload-button",o.innerText="Upload CSV",o.setAttribute("for","chart-uploadCSV");const p=document.createElement("input");p.type="file",p.id="chart-uploadCSV",p.name="filename",p.accept=".csv",p.style="display: none;",c.append(o,p);const s=document.createElement("div");s.className="input-group-btn group-dropdown trade-list-dropdown",s.style="width: 150px; display: inline-block; margin-right: 20px; display: none; float: right;",s.innerHTML='<button class="input-dropdown-btn" data-toggle="dropdown" aria-expanded="false" style="height: 30px;"><span class="rbx-selection-label ng-binding" title="All" style="font-size: 14px; line-height: 20px; overflow: hidden; text-overflow: ellipsis; max-width: calc(100% - 16px);">All</span><span class="icon-down-16x16" style="margin-top: 2px;"></span></button><ul data-toggle="dropdown-menu" class="dropdown-menu" role="menu"></ul>';const a=s.getElementsByClassName("rbx-selection-label")[0],h=s.getElementsByClassName("dropdown-menu")[0],n=document.createElement("canvas"),e=new Chart(n,{type:"line",options:{scales:{x:{title:{display:!0,text:"Day"}},y:{title:{display:!0,text:"Revenue before tax"}}},ticks:{sampleSize:1},animation:!1,spanGaps:!0,normalized:!0,bezierCurve:!1}});let t,g="Asset",d,l;async function r(){if(!t){const w={labels:[],datasets:[]};e.data=w,e.update();return}const I=SalesOfGoodsCSVToJSON(t),[y,A,D]=await ChartCSVTypes[g](I,d);if(D?typeof D!="boolean"&&(l=D,D.unshift({name:"All",value:void 0})):l=void 0,l&&l.length!==0){if(typeof D!="boolean"){h.replaceChildren(),a.innerText="All",a.title="All";for(let w=0;w<l.length;w++){const b=l[w],x=document.createElement("li");x.innerHTML='<a><span class="ng-scope" style="text-overflow: ellipsis; overflow: hidden; display: block;"></span></a>',x.getElementsByTagName("span")[0].innerText=b.name,x.getElementsByTagName("span")[0].title=b.name,h.appendChild(x),x.addEventListener("click",function(){a.innerText=b.name,a.title=b.name,d=b.value,r()})}s.style.display="inline-block"}}else s.style.display="none",h.replaceChildren();i.innerText=`Shows top ${A} for performance reasons`,e.data=y,e.update()}c.addEventListener("click",async function(I){t&&(t=null,p.value=null,d=void 0,HasFetched=!1,o.innerText="Upload CSV",I.stopImmediatePropagation(),await sleep(10),o.setAttribute("for","chart-uploadCSV"),r())}),c.addEventListener("change",function(I){const y=I.target.files[0];if(!y)return;let A=new FileReader;A.onload=async function(D){t=D.target.result,d=void 0,HasFetched=!1,o.removeAttribute("for"),o.innerText="Remove CSV",r()},A.readAsText(y)});const v=document.createElement("div");v.className="input-group-btn group-dropdown trade-list-dropdown",v.style="width: 150px; display: inline-block; margin-right: 20px; float: right;",v.innerHTML='<button class="input-dropdown-btn" data-toggle="dropdown" aria-expanded="false" style="height: 30px;"><span class="rbx-selection-label ng-binding" title="Asset" style="font-size: 14px; line-height: 20px; overflow: hidden; text-overflow: ellipsis; max-width: calc(100% - 16px);">Asset</span><span class="icon-down-16x16" style="margin-top: 2px;"></span></button><ul data-toggle="dropdown-menu" class="dropdown-menu" role="menu"><li class="ng-scope"><a><span class="ng-scope">Asset</span></a></li><li class="ng-scope"><a><span class="ng-scope">Place</span></a></li><li class="ng-scope"><a><span class="ng-scope">Affiliate Place</span></a></li><li class="ng-scope"><a><span class="ng-scope">User</span></a></li></ul>';const C=v.getElementsByClassName("rbx-selection-label")[0],T=v.getElementsByClassName("dropdown-menu")[0].children;for(let I=0;I<T.length;I++){const y=T[I],A=y.innerText;y.addEventListener("click",function(){C.title=A,C.innerText=A,g=A,d=void 0,r()})}return m.append(f,i,c,v,s,n),m}IsFeatureEnabled("CSVChart").then(async function(u){if(!u)return;const m=await CreateChart("Sales Of Goods");if(window.location.href.includes("group")){const f=await WaitForClass("configure-group-details");ChildAdded(f,!0,function(i){i.tagName&&i.tagName.toLowerCase()==="revenue-summary"&&i.appendChild(m)})}else{const f=await WaitForClass("user-transactions-container");ChildAdded(f,!0,function(i){i.className&&i.className==="summary"&&i.appendChild(m)})}});

//# sourceMappingURL=https://roqol.io/assets/sourcemap/chrome/2.33.1/js/pages/economy/chartcsv.js